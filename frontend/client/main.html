<head>
  <title>Token auction</title>
  <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
</head>
<body>
  <div id="outer" class="container">
    <div id="inner">
      <h1>WEEKLY MKR AUCTION</h1>
      {{> networkStatus}}
      {{> balance}}
      {{> auction}}
      {{> auctionlet}}
      {{> newauction}}
    </div>
  </div>
</body>

<template name="auctionlet">
  <div class="boxDiv">
    <h2>Auctionlet</h2>
    {{#unless auctionNotFound}}
      <table class="table">
        <tr>
          <td>Auctionlet id</td>
          <td>{{auctionlet.auctionletId}}</td>
        </tr>
        {{#if unclaimed}}
        <tr>
          <td>Selling</td>
          <td>{{formatBalance (fromWei auctionlet.sell_amount)}} <a class="MKR" href="{{etherscanHref}}{{MKRToken.address}}" target="_blank">{{MKRToken.name}}</a></td>
        </tr>
        {{#unless auctionlet.base}}
          <tr>
            <td>Last bidder</td>
            <td><a href="{{etherscanHref}}{{auctionlet.last_bidder}}">{{auctionlet.last_bidder}}</a></td>
          </tr>
          <tr>
            <td>Last bid time</td>
            <td>{{auctionlet.last_bid_time}}</td>
          </tr>
          <tr>
            <td>Time remaining</td>
            <td>{{countdown}} seconds</td>
          </tr>
        {{/unless}}
        <tr>
          {{#if auctionlet.base}}
            <td>Initial bid</td>
          {{else}}
            <td>Highest bid</td>
          {{/if}}
          <td>{{formatBalance (fromWei auctionlet.buy_amount)}} <a class="ETH" href="{{etherscanHref}}{{ETHToken.address}}" target="_blank">{{ETHToken.name}}</a></td>
        </tr>
        {{/if}}
      </table>
      {{#unless expired}}
      <div class="form-group">
        <label for="inputBid">Enter a bid for the auctionlet</label>
        <input class="form-control" id="inputBid" type="number" min="{{bid}}" value="{{bid}}" {{b "value: bid"}}>
        <button class="btn btn-primary" {{b "click: create"}}>Place bid</button>
        {{#if bidMessage}}
          <br>
          <span id='spnBidMessage' class="messageSpan alert {{bidMessageType}}">{{ bidMessage }}</span>
        {{/if}}
      </div>
      {{else}}
      <div class="form-group">
        <span>Auctionlet has expired.</span>
        {{#unless unclaimed}}
          <br/>
          <span>The tokens have been claimed by the auctionlet winner</span>
        {{/unless}}
        {{#if auctionwinner}}
          {{#if auctionlet.unclaimed}}
          <br>
            <span>You made the highest bid. Click to receive the tokens</span>
            <button class="btn btn-primary" {{b "click: claim"}}>Claim</button>
            {{#if claimMessage}}
              <span id='spnClaimMessage' class="messageSpan alert {{claimMessageType}}">{{ claimMessage }}</span>
            {{/if}}
          {{/if}}
        {{/if}}
      </div>
      {{/unless}}
    {{else}}
      <span>Auctionlet was not found</span>
    {{/unless}}
  </div>
</template>